import{a as O}from"./chunk-NSESJNCW.js";import{a as z}from"./chunk-JOHXSRUU.js";import{a as q,b as A}from"./chunk-KHWLHTTU.js";import{a as B}from"./chunk-FYG3A6Z3.js";import{b as E,c as _,e as F,f as M,h as j,j as V,k as D,l as R,m as U,n as G}from"./chunk-JEB2BSX2.js";import{a as J}from"./chunk-EB42JTE5.js";import"./chunk-NB3MO2E5.js";import{l as T}from"./chunk-L4FLERUP.js";import"./chunk-E7LQUBD3.js";import{W as b}from"./chunk-I6UTEODU.js";import"./chunk-JPM7ZRFP.js";import"./chunk-NMGI7OHJ.js";import{c as N,d as k}from"./chunk-OYDM5OEP.js";import{aa as I}from"./chunk-TRTIGX42.js";import{Dc as p,Ec as d,Gb as g,Lb as n,Sb as o,Tb as s,Ub as a,ca as C,dc as v,i as S,nc as h,oc as f,pb as i,pc as y,qb as c,va as P,vc as x,zb as l}from"./chunk-K2EQSHJF.js";function H(t,u){t&1&&a(0,"i",24)}function Q(t,u){t&1&&a(0,"i",25)}function W(t,u){t&1&&a(0,"i",24)}function X(t,u){t&1&&a(0,"i",25)}function Y(t,u){t&1&&a(0,"i",24)}function Z(t,u){t&1&&a(0,"i",25)}function $(t,u){t&1&&a(0,"i",26)}var we=(()=>{class t{constructor(r,m,e,w,K,L){this._FormBuilder=r,this._UserService=m,this._ToastrService=e,this._Store=w,this._CookieService=K,this._Router=L,this.load=l(!1),this.hidenPassword=l(!0),this.hideNewPassword=l(!0),this.togglePassword=()=>this.hidenPassword=l(!this.hidenPassword()),this.toggleNewPassword=()=>this.hideNewPassword=l(!this.hideNewPassword())}encrypt(r){return CryptoJS.AES.encrypt(JSON.stringify(r),z.TokenSecretKey).toString()}setCookie(r){this._CookieService.set("userToken",this.encrypt(r),{expires:30,path:"/",secure:!0,sameSite:"Strict"})}submit(){this.load=l(!0),this.form.status=="VALID"?this.changePassword():this.form.hasError("passwordMismatch")&&this._ToastrService.error(localStorage.getItem("lang")=="en"?"Password and confirm not match":"\u0643\u0644\u0645\u0629 \u0627\u0644\u0645\u0631\u0648\u0631 \u0644\u0627 \u062A\u0648\u0627\u0641\u0642 \u062A\u0623\u0643\u064A\u062F \u0643\u0644\u0645\u0629 \u0627\u0644\u0645\u0631\u0648\u0631")}changePassword(){this._UserService.changePassword(this.form.value).pipe(C(r=>{this.load=l(!1),this._ToastrService.success(r.message),this._Store.dispatch(q({token:r.data.token})),this.setCookie(r.data.token),this._Router.navigate(["/home"])})).subscribe(S,r=>{this._ToastrService.error(r.error.message),r.error.code==401&&(this._CookieService.delete("userToken"),this._Store.dispatch(A()),this._Router.navigate(["/sign-in"])),this.load=l(!1)})}passwordMatchValidator(r){let m=r.get("password")?.value,e=r.get("confirmPassword")?.value;return m===e?null:{passwordMismatch:!0}}ngOnInit(){this.form=this._FormBuilder.group({currentPassword:["",[_.required]],password:["",[_.required]],confirmPassword:["",[_.required]]},{validators:this.passwordMatchValidator})}static{this.\u0275fac=function(m){return new(m||t)(c(R),c(O),c(J),c(T),c(B),c(b))}}static{this.\u0275cmp=P({type:t,selectors:[["app-change-password"]],standalone:!0,features:[x],decls:49,vars:38,consts:[[1,"flex","items-center"],[1,"container","mx-auto"],[1,"inner","flex","justify-center"],["wow-data-duration","1.5s",1,"w-full","lg:w-1/3","rounded-md","lg:border","lg:shadow-md","lg:hover:shadow-main-lighter","lg:hover:border-main-solid","duration-200","p-5","wow","fadeIn"],[1,"heading","mb-5","flex","items-center","gap-2"],["loading","lazy","src","logo.png","alt","logo",1,"w-14"],[1,"content"],[1,"text-3xl","font-extrabold","text-main-solid"],[1,"text-lg","font-thin","text-main-light"],[1,"form"],[3,"ngSubmit","formGroup"],[1,"form-control","mb-3","red"],["for","pass"],[1,"relative"],["id","password","formControlName","currentPassword",1,"peer/input",3,"type","placeholder"],["type","button","for","password",1,"absolute","text-gray-400","-translate-y-1/2","top-1/2","ltr:right-2","rtl:left-2","peer-focus/input:text-main-solid",3,"click"],["class","text-lg pi pi-eye",4,"ngIf"],["class","text-lg pi pi-eye-slash",4,"ngIf"],["for","new-pass"],["id","new-pass","formControlName","password",1,"peer/input",3,"type","placeholder"],["for","new-confirm"],["id","new-confirm","formControlName","confirmPassword",1,"peer/input",3,"type","placeholder"],[1,"btn-main","w-full","mt-5","rounded-md","flex","items-center","gap-2","justify-center"],["class","pi pi-spinner animate-spin",4,"ngIf"],[1,"text-lg","pi","pi-eye"],[1,"text-lg","pi","pi-eye-slash"],[1,"pi","pi-spinner","animate-spin"]],template:function(m,e){m&1&&(o(0,"section",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4),a(5,"img",5),o(6,"div",6)(7,"h2",7),h(8),p(9,"translate"),s(),o(10,"span",8),h(11),p(12,"translate"),s()()(),o(13,"div",9)(14,"form",10),v("ngSubmit",function(){return e.submit()}),o(15,"div",11)(16,"label",12),h(17),p(18,"translate"),s(),o(19,"div",13),a(20,"input",14),p(21,"translate"),o(22,"button",15),v("click",function(){return e.togglePassword()}),g(23,H,1,0,"i",16)(24,Q,1,0,"i",17),s()()(),o(25,"div",11)(26,"label",18),h(27),p(28,"translate"),s(),o(29,"div",13),a(30,"input",19),p(31,"translate"),o(32,"button",15),v("click",function(){return e.toggleNewPassword()}),g(33,W,1,0,"i",16)(34,X,1,0,"i",17),s()()(),o(35,"div",11)(36,"label",20),h(37),p(38,"translate"),s(),o(39,"div",13),a(40,"input",21),p(41,"translate"),o(42,"button",15),v("click",function(){return e.toggleNewPassword()}),g(43,Y,1,0,"i",16)(44,Z,1,0,"i",17),s()()(),o(45,"button",22),h(46),p(47,"translate"),g(48,$,1,0,"i",23),s()()()()()()()),m&2&&(i(8),f(d(9,20,"account.change-password")),i(3),f(d(12,22,"account.change-password-hint")),i(3),n("formGroup",e.form),i(3),f(d(18,24,"account.password")),i(3),n("type",e.hidenPassword()?"password":"text")("placeholder",d(21,26,"account.pass-placeholder")),i(3),n("ngIf",!e.hidenPassword()),i(),n("ngIf",e.hidenPassword()),i(3),f(d(28,28,"account.new-password")),i(3),n("type",e.hideNewPassword()?"password":"text")("placeholder",d(31,30,"account.new-pass-placeholder")),i(3),n("ngIf",!e.hideNewPassword()),i(),n("ngIf",e.hideNewPassword()),i(3),f(d(38,32,"account.confirm-pass")),i(3),n("type",e.hideNewPassword()?"password":"text")("placeholder",d(41,34,"account.confirm-placeholder")),i(3),n("ngIf",!e.hideNewPassword()),i(),n("ngIf",e.hideNewPassword()),i(2),y("",d(47,36,"account.change-password")," "),i(2),n("ngIf",e.load()))},dependencies:[k,N,U,j,E,F,M,I,G,V,D]})}}return t})();export{we as ChangePasswordComponent};
